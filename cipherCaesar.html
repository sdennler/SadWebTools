<!DOCTYPE HTML>
<html lang="en">
<head>
<title>Caesar Cipher</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Ulli Meybohms HTML EDITOR">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="style.css" type="text/css" media="screen" />
</head>
<body>

<h1>Caesar Cipher</h1>

<script>
    /**
     * Run Cipher / Decipher
     * @param {Integer} mode 0 for cipher, 1 for decipher
     */
    function runCipher(mode = 1){
        var InputString = document.getElementById('InputString');
        var OutputString = document.getElementById('OutputString');
        var shiftInput = document.getElementById('shift');

        var shift = parseInt(shiftInput.value) * mode;
        if(isNaN(shift)){
            shift = 13;
            shiftInput.value = shift;
        }
        OutputString.value = CaesarCipher(InputString.value, shift);
    }

    /**
     * Calculate the Caesar Chipher
     * @param {String} input
     * @param {Integer} shift Number of steps, use negative numbers to decipher
     * @returns {String} output
     */
    function CaesarCipher(input, shift){

        /**
         * Calculates one character
         * @param {Integer} char Number representing the character. The first character (example is A) must be represented as 0.
         * @param {Integer} shift Number of steps.
         * @param {Integer} charcount Number of characters in the current set.
         * @returns {Integer}
         */
        function cipher(char, shift, charcount){
            char = (char + shift) % charcount;
            if(char < 0) char += charcount;
            return char;
        }

        var out = '';

        for (var i = 0; i < input.length; i++) { // Do for each character in input
            var char = input.charCodeAt(i);

            if(char >= 65 && char <= 90){ // A-Z
                char -= 65;
                char = cipher(char, shift, 26);
                char += 65;
            }
            else if (char >= 97 && char <= 122){ // a-z
                char -= 97;
                char = cipher(char, shift, 26);
                char += 97;
            }
            else if (char >= 48 && char <= 57){ // 0-9
                char -= 48;
                char = cipher(char, shift, 10);
                char += 48;
            }
            // All other characters will be left untouched.

            out += String.fromCharCode(char);
        }

        return out;
    }


    /**
     * Run brute force break which will output all possible solutions.
     */
    function runBreakIt(){
        var InputString = document.getElementById('InputString');
        var OutputString = document.getElementById('OutputString');

        OutputString.value = "Let's try 'em all:\n---\n";
        for (var i = 0; i <= 26; i++) {
            console.log('try '+i);
            OutputString.value += i+': ';
            OutputString.value += CaesarCipher(InputString.value, i * -1);
            OutputString.value += "\n---\n";
        }
    }


    /**
     * Copy the content from the output textarea to the input
     */
    function copyOut2In(){
        document.getElementById('InputString').value = document.getElementById('OutputString').value;
    }
</script>

<form action="#" accept-charset="UTF-8">

<textarea name="InputString" id="InputString" cols="120" rows="12"></textarea> <label for="InputString" class="textarea">In</label>

<div class="controls">
<label for="shift">Key:</label> <input type="number" id="shift" name="shift" min="-26" max="26" value="13" />
<input type="Button" name="cipher" value="Cipher" onclick="runCipher();">
<input type="Button" name="decipher" value="Decipher" onclick="runCipher(-1);">
<input type="Button" name="break" value="Break it" onclick="runBreakIt();">
</div>

<textarea name="OutputString" id="OutputString" cols="120" rows="12"></textarea> <label for="InputString" class="textarea">Out</label>

<div class="controls">
<button type="reset" value="Reset">Clear</button>
<input type="Button" name="copy" value="Copy Out to In" onclick="copyOut2In();">
</div>

</form>

</body>
</html>
